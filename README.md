# parsing_fire

Скрипт представляет собой инструмент для автоматического парсинга данных с веб-сайта и их сохранения в базу данных MySQL. Он работает в несколько этапов: загрузка HTML-страниц, извлечение нужной информации, очистка предыдущих данных и сохранение новых. Скрипт предназначен для обработки большого количества данных из различных категорий товаров. Вот основные аспекты его работы:

## 1. Подготовка окружения
+ Устанавливается кодировка UTF-8 и региональные настройки ru_RU.UTF-8.
+ Включается вывод и логирование ошибок для отладки (php-error.log).
+ Увеличивается лимит времени выполнения и памяти, чтобы избежать ошибок при обработке большого объема данных.
## 2. Подключение к базе данных
+ Используется библиотека Krugozor\Database\Mysql для работы с базой данных data_db.
+ База данных настраивается на русский язык ошибок и кодировку utf8.
+ Активируется логирование SQL-запросов для отладки.
## 3. Определение URL-адресов для парсинга
URL-адреса разделены на несколько категорий, соответствующих разным таблицам базы данных:
+ Печи для дома (data).
+ Каминные топки (data2).
+ Банные печи (data3).
+ Котлы (data4).
+ Прочие товары (data5).
## 4. Функция парсинга parseCatalog
+ Удаляет старые данные из таблицы базы данных с помощью TRUNCATE TABLE.
+ Для каждого URL выполняется:
    - Загрузка HTML-контента страницы с помощью библиотеки GuzzleHttp.
    - Парсинг HTML с использованием DiDom для извлечения данных:
    - Название товара.
    - Статус наличия.
    - Изображение.
    - Цена.
+ Загрузка дополнительных данных (описание и характеристики) со страницы товара.
+ Собранные данные сохраняются в массив $arrMainParams.
+ После завершения парсинга данные из массива вставляются в базу данных с помощью массовых операций (INSERT).

## 5. Обработка категорий
Функция вызывается отдельно для каждой категории URL и соответствующей таблицы в базе данных.
## 6. Логика парсинга
+ Данные собираются с HTML-структуры страниц с использованием классов и селекторов, характерных для сайта.
+ Ожидания (sleep) между запросами помогают избежать блокировки со стороны сервера.
## 7. Вывод результатов
Скрипт выводит сообщения на каждом этапе выполнения, чтобы отслеживать процесс: удаление старых данных, загрузка новых, этапы парсинга и запись данных.

## Применение
Скрипт предназначен для автоматизации парсинга данных из интернет-магазинов и их структурирования в базу данных для последующего анализа или интеграции с другими системами, такими как OpenCart.

## Требования
- PHP 7.4 или выше.
- Библиотеки:
- DiDom — для парсинга HTML.
- GuzzleHttp — для HTTP-запросов.
- Krugozor\Database\Mysql — для работы с MySQL.
